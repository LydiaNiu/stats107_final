---
title: "Final Report"
output: pdf_document
date: "2025-03-17"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("00_requirements.R")
source("01_func_DataCleaning.R")
source("02_func_dVisual_PlotDensity.R")
source("03_func_dVisual_BoxPlot.R")
source("04_func_dVisual_BarChart.R")
df <- read.csv("cleaned_sleep_health_data.csv")
```

# I am the title

## ABSTRACT

## INTRODUCTION

## DATA

### variables: 
- Sleep Disorder: The presence or absence of a sleep disorder in the person (None, Insomnia, Sleep Apnea).
- Quality of Sleep (Scale: 1-10): A subjective rating of the quality of sleep, ranging from 1 to 10.
- Stress Level (Scale: 1-10): A subjective rating of the stress level experienced by the person, ranging from 1 to 10.

## VISUALIZATION

```{r , echo=FALSE, warning=FALSE}
# check whether it's normally distributed
shapiro_sleep <- shapiro.test(df$sleep_quality)
shapiro_stress <- shapiro.test(df$stress)

# p-value to determine its normality
if (shapiro_sleep$p.value > 0.05 & shapiro_stress$p.value > 0.05) {
  # Pearson correlation
  correlation_test <- cor.test(df$sleep_quality, df$stress, method = "pearson")
} else {
  # Spearman correlation
  correlation_test <- cor.test(df$sleep_quality, df$stress, method = "spearman")
}
# Visualization of correlation
ggscatter(df, x = "stress", y = "sleep_quality",
          add = "reg.line", conf.int = TRUE, 
          cor.coef = TRUE, cor.method = correlation_test$method,
          xlab = "Stress Level", ylab = "Sleep Quality")
```
- P-value: 2.2e-16
- rho value:  -0.908
The p-value is extremely small, meaning the correlation is highly statistically significant. This suggests that the relationship between stress and sleep quality is not due to random chance. The high correlation also being confirmed by the -0.908 rho value and the scatter plot, indicates a strong negative correlation between sleep quality and stress. 

This project uses a **t-test** because it is a statistical method specifically designed to **compare the means of two groups**. Since my goal is to analyze whether **sleep quality and stress levels differ between individuals with and without sleep disorders (None, Sleep Apnea, Insomnia)**, the t-test is an appropriate choice. It allows us to test the null hypothesis that the means of two groups are equal, while accounting for variability in the data. By using the **p-value and confidence intervals**, we can assess whether the differences we observe are due to chance or represent a meaningful pattern in sleep health.

### Density plots for 6 tests:

```{r density_plots_page1, fig.width=25, fig.height=30, echo=FALSE, warning=FALSE, message=FALSE}
# 1. sleep quality of sleep apnea vs sleep quality of insomnia
t_test_result1 <- t.test(df$sleep_quality[df$disorder == "Sleep Apnea"],
       df$sleep_quality[df$disorder == "Insomnia"])
dplot1 <- plot_density(df,"sleep_quality", "Sleep Apnea", "Insomnia", "Figure1: Sleep Quality: Sleep Apnea vs. Insomnia")

# 2. the stress level with the ppl with sleep apnea vs thestress level with the ppl with insomnia
t_test_result2 <- t.test(df$stress[df$disorder == "Sleep Apnea"],
       df$stress[df$disorder == "Insomnia"])
dplot2 <- plot_density(df, "stress", "Sleep Apnea", "Insomnia", "Figure2: Stress Level: Sleep Apnea vs. Insomnia")

# 3. the quality of sleeping with the ppl without sleeping disorder vs the quality of sleeping with the ppl with insomnia 
t_test_result3 <- t.test(df$sleep_quality[df$disorder == "None"],
       df$sleep_quality[df$disorder == "Insomnia"])
dplot3 <- plot_density(df, "sleep_quality", "None", "Insomnia", "Figure3: Sleep Quality: No Disorder vs. Insomnia")

grid.arrange(dplot1, dplot2, dplot3, ncol = 1, nrow = 3, heights = c(1, 1, 1))
```

```{r density_plots_page2, fig.width=25, fig.height=30, echo=FALSE, warning=FALSE, message=FALSE}
# 4. the quality of sleeping with the ppl without sleeping disorder vs the quality of sleeping with the ppl with sleep apnea
t_test_result4 <- t.test(df$sleep_quality[df$disorder == "None"],
       df$sleep_quality[df$disorder == "Sleep Apnea"])
dplot4 <- plot_density(df, "sleep_quality", "None", "Sleep Apnea", "Figure4: Sleep Quality: No Disorder vs. Sleep Apnea")

# 5. the stress level with the ppl without sleeping disorder vs the stress levelwith the ppl with insomnia 
t_test_result5 <- t.test(df$stress[df$disorder == "None"],
       df$stress[df$disorder == "Insomnia"])
dplot5 <- plot_density(df, "stress", "None", "Insomnia", "Figure5: Stress Level: No Disorder vs. Insomnia")

# 6. the stress level with the ppl without sleeping disorder vs the stress levelwith the ppl with sleep apnea. 
t_test_result6 <- t.test(df$stress[df$disorder == "None"],
       df$stress[df$disorder == "Sleep Apnea"])
dplot6 <- plot_density(df, "stress", "None", "Sleep Apnea", "Figure6: Stress Level: No Disorder vs. Sleep Apnea")

grid.arrange(dplot4, dplot5, dplot6, ncol = 1, nrow = 3)

```

### Box plots for the 6 testsd

```{r box_plots_page1, fig.width=18, fig.height=30, echo=FALSE, warning=FALSE, message=FALSE}  
bplot1 <- plot_boxplot(df, "sleep_quality", "disorder", "Sleep Apnea", "Insomnia", "Figure7: Sleep Quality: Sleep Apnea vs. Insomnia")
bplot2 <- plot_boxplot(df, "stress", "disorder", "Sleep Apnea", "Insomnia", "Figure8: Stress Level: Sleep Apnea vs. Insomnia")
bplot3 <- plot_boxplot(df, "sleep_quality", "disorder", "None", "Insomnia", "Figure9: Sleep Quality: No Disorder vs. Insomnia")

grid.arrange(bplot1, bplot2, bplot3, ncol = 1, nrow = 3)
```

```{r, fig.width=18, fig.height=25, echo=FALSE, warning=FALSE, message=FALSE}
bplot4 <- plot_boxplot(df, "sleep_quality", "disorder", "None", "Sleep Apnea", "Figure10: Sleep Quality: No Disorder vs. Sleep Apnea")
bplot5 <- plot_boxplot(df, "stress", "disorder", "None", "Insomnia", "Figure11: Stress Level: No Disorder vs. Insomnia")
bplot6 <- plot_boxplot(df, "stress", "disorder", "None", "Sleep Apnea", "Figure12: Stress Level: No Disorder vs. Sleep Apnea")
grid.arrange(bplot4, bplot5, bplot6, ncol = 1, nrow = 3)
```


### Four-quadrant distribution chart

```{r box_plots_page2, fig.width= 25, fig.height=25, echo=FALSE, warning=FALSE, message=FALSE}
ggplot(df, aes(x = stress, y = sleep_quality, color = disorder, shape = disorder)) +
  geom_point(size = 10, alpha = 0.8) +
  geom_vline(xintercept = median(df$stress, na.rm = TRUE), linetype = "dotted", color = "black", size = 1) +
  geom_hline(yintercept = median(df$sleep_quality, na.rm = TRUE), linetype = "dotted", color = "black", size = 1) +
  labs(
    title = "Four-Quadrant Distribution of Stress & Sleep Quality",
    x = "Stress Level",
    y = "Sleep Quality",
    color = "Disorder",
    shape = "Disorder"  # Merge shape & color legends
  ) +
  theme_minimal() +
  theme(
    text = element_text(size = 40),
    legend.text = element_text(size = 35),
    legend.title = element_text(size = 35),
    plot.title = element_text(size = 50, face = "bold")
  ) +
  guides(color = guide_legend(override.aes = list(size = 8)))  # Adjust legend size

```


## ANALYSIS
### Analyzing the t-tests
### Analyzing the box plots
The box plots provide a visual comparison of sleep quality and stress levels across different groups based on sleep disorder status. By examining the distribution of values within each group, we can observe key differences in central tendency and variability.


### Analyzing the four-quadrant distribution chart
The four-quadrant plot visually maps individuals based on their stress levels (x-axis) and sleep quality (y-axis), with each point representing a response and colored according to their sleep disorder category. The median values of sleep quality and stress serve as reference lines, dividing the graph into four quadrants. Median is less sensitive to outliers and skewed data, and it also divides the dataset into two equal halves, making it useful for visualization.

- Top-Left Quadrant (High Sleep Quality, Low Stress):

    This area is predominantly occupied by individuals with **Sleep Apnea**. Their placement suggests that while they experience a diagnosed sleep disorder, their self-reported sleep quality remains relatively high, and their stress levels are relatively low.
    
- Bottom-Right Quadrant (Low Sleep Quality, High Stress):

    Individuals with **Insomnia** are concentrated in this quadrant. This indicates that they generally report poorer sleep quality and higher stress, reinforcing previous findings from the box plots.
  
- Top-Right Quadrant (High Sleep Quality, High Stress):

    Some individuals, particularly from the **None** group, appear in this section. This suggests that not all individuals without a sleep disorder experience low stressâ€”some may still have high stress despite reporting good sleep quality.

- Bottom-Left Quadrant (Low Sleep Quality, Low Stress): 

  This area contains no responses. This suggests the correlation of sleep quality and stress level is positive, which as the sleep

## CONCLUSION
